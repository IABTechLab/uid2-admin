<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="/js/main.js"></script>
</head>
<body>
<h1>UID2 Admin - Site Management</h1>

<a href="/">Back</a>

<br>
<br>

<h3>Inputs</h3>

<div>
    <label for="siteName">Name:</label>
    <input type="text" id="siteName" name="siteName">
    <label for="siteId">Site Id:</label>
    <input type="text" id="siteId" name="siteId">
    <label for="types">Types:</label>
    <input type="text" id="types" name="types">
</div>
<br>
<div>
    <label for="domainNames">Domain Names:</label>
    <input type="text" id="domainNames" name="domainNames" style="width: 500px;">
</div>

<br>
<br>

<h3>Operations</h3>

<ul>
    <li class="ro-cki" style="display: none"><a href="#" id="doList">List Sites</a></li>
    <li class="ro-cki" style="display: none"><a href="#" id="doAdd">Add Site</a></li>
    <li class="ro-cki" style="display: none"><a href="#" id="doEnable">Enable Site</a></li>
    <li class="ro-cki" style="display: none"><a href="#" id="doDisable">Disable Site</a></li>
    <li class="ro-cki" style="display: none"><a href="#" id="doSetTypes">Set Types</a></li>
    <li class="ro-cki" style="display: none"><a href="#" id="doDomainNames">Set Site Domain Names</a></li>
</ul>

<br>

<h3>Output</h3>

<div id="output">
    <pre id="errorOutput"></pre>
    <pre id="standardOutput"></pre>
</div>

<script language="JavaScript">
    $(document).ready(function () {
        $('#doList').on('click', function () {
            doApiCall('GET', '/api/site/list', '#standardOutput', '#errorOutput');
        });

        $('#doAdd').on('click', function () {
            var siteName = encodeURIComponent($('#siteName').val());
            var types = encodeURIComponent($('#types').val());
            var url = '/api/site/add?name=' + siteName + '&types=' + types;

            let domainNames = ($('#domainNames').val()).replace(/\s+/g, '').split(',').filter( (value, _, __) => value !== "");
            doApiCall('POST', url, '#standardOutput', '#errorOutput', JSON.stringify({domain_names : domainNames}));
        });

        $('#doDisable').on('click', function () {
            var siteId = encodeURIComponent($('#siteId').val());
            var url = '/api/site/enable?enabled=false&id=' + siteId;

            doApiCall('POST', url, '#standardOutput', '#errorOutput');
        });

        $('#doEnable').on('click', function () {
            var siteId = encodeURIComponent($('#siteId').val());
            var url = '/api/site/enable?enabled=true&id=' + siteId;

            doApiCall('POST', url, '#standardOutput', '#errorOutput');
        });
        $('#doSetTypes').on('click', function () {
            var siteId = encodeURIComponent($('#siteId').val());
            var types = encodeURIComponent($('#types').val());
            var url = '/api/site/set-types?id=' + siteId + '&types=' + types;

            doApiCall('POST', url, '#standardOutput', '#errorOutpout');
        });

        $('#doDomainNames').on('click', function () {
            var siteId = encodeURIComponent($('#siteId').val());
            var url = '/api/site/domain_names?id=' + siteId;

            let domainNames = ($('#domainNames').val()).replace(/\s+/g, '').split(',').filter( (value, _, __) => value !== "");

            const payload = { domain_names: domainNames }

            doApiCall('POST', url, '#standardOutput', '#errorOutput', JSON.stringify(payload));
        });
    });
</script>

</body>
</html>
