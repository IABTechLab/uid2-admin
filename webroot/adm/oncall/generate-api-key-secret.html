<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="/js/main.js"></script>
</head>
<body>
<h1>UID2 Env - On-call - Generate API Key/Secret</h1>

<a href="/">Back</a>

<br>
<br>

<h3>Please input the participant's name.</h3>
<label for="participantName">Name:</label>
<input type="text" id="participantName" name="participantName">
<a href="#" id="searchParticipant">Search</a>

<br>

<pre id="siteSearchOutput"></pre>

<br>

<h3>Output</h3>

<div id="output">
    <pre id="errorOutput"></pre>
    <pre id="standardOutput"></pre>
</div>

<script language="JavaScript">
    let similarSiteList = [];

    $(document).ready(() => {
        $("#searchParticipant").on("click", () => {
            const participantName = encodeURIComponent($("#participantName").val());

            doApiCallWithCallback("GET", "/api/site/list", text => {
                const siteList = JSON.parse(text);

                similarSiteList = siteList.filter(s => s.name.toLowerCase().includes(participantName.toLowerCase()));

                if (similarSiteList.length > 0) {
                    $(siteSearchOutput).text(JSON.stringify(similarSiteList, null, 2));
                } else {
                    $(siteSearchOutput).text("No sites found");
                }
            }, errorCallback)
        });
    });
</script>

</body>
</html>
